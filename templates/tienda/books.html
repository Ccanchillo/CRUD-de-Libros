{% extends 'base.html' %}

{% block title %}Libros{% endblock %}

{% block content %}
<div class="container" style="padding: 2rem 1rem;">
    <h1 style="margin-bottom: 1rem;">Libros</h1>

    <form method="post" action="" style="margin-bottom: 1.5rem;">
        {% csrf_token %}
        <div style="display:flex; gap: .5rem; flex-wrap: wrap;">
            <input type="text" name="title" placeholder="Título" required>
            <input type="text" name="author" placeholder="Autor" required>
            <input type="date" name="published_date" placeholder="Fecha publicación">
            <button type="submit" class="btn btn-primary">Agregar</button>
        </div>
    </form>

    <table class="table table-books">
        <thead>
            <tr>
                <th>Título</th>
                <th>Autor</th>
                <th>Publicado</th>
                <th>Disponible</th>
                <th class="col-actions">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for book in books %}
            <tr>
                <td>{{ book.title }}</td>
                <td>{{ book.author }}</td>
                <td>{{ book.published_date|default:'-' }}</td>
                <td>
                    {% if book.available %}
                        Sí
                    {% else %}
                        No
                    {% endif %}
                </td>
                <td class="actions">
                    <a href="{% url 'edit_book' book.id %}" class="btn btn-secondary">Editar</a>
                    <form method="post" action="{% url 'toggle_book' book.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-outline">{% if book.available %}Marcar prestado{% else %}Marcar devuelto{% endif %}</button>
                    </form>
                    <form method="post" action="{% url 'delete_book' book.id %}" onsubmit="return confirm('¿Eliminar libro?')">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Eliminar</button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5">No hay libros aún.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

